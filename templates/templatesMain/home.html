<!-- pagina home clientes -->

<!-- herencia para la pagina base-cliente -->
{% extends "templatesMain/base-cliente.html" %}
{% load static %}
<!-- cambio de titulo de la pagina -->
{% block title %}SERVICOPIAPO PROPIEDADES {% endblock %}


<!-- prueba de contenido dinamico -->
{% block content %}
<!-- Carrusel -->
<!-- Carrusel de ancho completo -->
<div id="carouselExampleFade" class="carousel slide carousel-fade w-100" data-bs-ride="carousel">
  <div class="carousel-inner">
    <div class="carousel-item active">
      <img src="https://placehold.co/1920x400?text=placeholder" class="d-block w-100" alt="">
    </div>
    <div class="carousel-item">
      <img src="https://placehold.co/1920x400?text=placeholder2" class="d-block w-100" alt="">
    </div>
    <div class="carousel-item">
      <img src="https://placehold.co/1920x400?text=placeholder3" class="d-block w-100" alt="">
    </div>
  </div>
  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleFade" data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Previous</span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleFade" data-bs-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Next</span>
  </button>
</div>



<!-- BARRA DE BUSQUEDA -->
<div class="container d-flex justify-content-center mt-4 mb-4">
  <form class="row g-2 align-items-center">
    <!-- seleccion de estado de propiedad -->
    <div class="col-auto">
      <select class="form-select">
        <option selected>Operación</option>
              {% for o in operacion %}
                <option value="{{ o|lower }}">{{ o }}</option>
              {% endfor %}
      </select>
    </div>
    
    <!-- seleccion de tipo de propiedad -->
    <div class="col-auto">
      <select class="form-select">
        <option selected>Tipo de inmueble</option>
              {% for t in tipos_inmueble %}
                <option value="{{ t|lower }}">{{ t }}</option>
              {% endfor %}
      </select>
    </div>
    <!-- seleccion de comuna -->
    <div class="col-auto">
        <select class="form-select">
            <option selected>Comuna</option>
              {% for c in comuna %}
                <option value="{{ c|lower }}">{{ c }}</option>
              {% endfor %}
        </select>
        </div>


    <!-- Botón -->
    <div class="col-auto">
      <button type="submit" class="btn btn-primary">Buscar</button>
    </div>



  </form>
</div>

    <!-- FIN BARRA DE BUSQUEDA -->
    <!-- grid cards -->
<div class="row">
  {% for p in propiedades %}
  <div class="col-md-4 mb-4">
    <a href="{% url 'detalle-propiedad' p.id %}" class="text-decoration-none text-dark">
      <div class="card h-100 shadow-sm border-0 rounded-3">
        <!-- Imagen principal -->
        {% if p.thumb %}
          <img src="{{ p.thumb.url }}" class="card-img-top" alt="{{ p.titulo }}">
        {% else %}
          <img src="{% static 'img/no-image.png' %}" class="card-img-top" alt="Sin imagen">
        {% endif %}

        <div class="card-body">
          <h5 class="card-title">{{ p.titulo }}</h5>
          {% if p.ubicacion %}
            <p class="text-muted small mb-2"><i class="bi bi-geo-alt"></i> {{ p.ubicacion }}</p>
          {% endif %}
          {% if p.precio %}
            <p class="fw-bold text-primary mb-0">
              {{ p.moneda }} {{ p.precio }}
            </p>
          {% endif %}
        </div>
      </div>
    </a>
  </div>
  {% empty %}
  <p>No hay propiedades disponibles.</p>
  {% endfor %}
</div>

<!-- SECCION DE SUSCRIPCION -->
<div class="container my-5">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <div class="card shadow-sm p-4 text-center">
        <h5 class="card-title mb-3">¡Suscríbete para recibir avisos de nuevas propiedades!</h5>
        <p class="card-text mb-4">Recibe información directamente en tu correo sobre propiedades nuevas, promociones y más.</p>
        <form method="POST" action="#" id="formSuscripcion">
            {% csrf_token %}
          <div class="input-group mb-3">
            <input type="email" class="form-control" placeholder="Tu correo electrónico" name="email" required>
            <button class="btn btn-primary" type="submit">Suscribirme</button>
          </div>
          <small class="text-muted">Nunca compartiremos tu correo con terceros.</small>
        </form>
        <div id="mensajeSuscripcion" class="mt-2"></div>
      </div>
    </div>
  </div>
</div>
<script>
  document.getElementById('formSuscripcion').addEventListener('submit', function(e){
    e.preventDefault(); // evita que recargue la página
    const email = this.email.value;
    
    if(email){
      document.getElementById('mensajeSuscripcion').innerHTML = `<span class="text-success">¡Gracias por suscribirte!</span>`;
      this.reset(); // limpia el input
    }
  });
</script>
{% endblock %}